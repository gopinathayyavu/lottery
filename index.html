<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Big Boss</title>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    html,
    body {
      height: 100%;
      margin: 0;
    }

    body {
      font-family: 'Outfit', sans-serif;
      background-image: url('assets/home-page.gif');
      background-repeat: no-repeat;
      background-size: cover;
      color: #1a1a1a;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      overflow-x: hidden;
      align-items: center;
      font-family: 'Orbitron', sans-serif;
    }

    h1 {
      font-size: 2.7rem;
      color: gold;
      font-weight: bold;
      letter-spacing: 1px;
      text-shadow: 0 1px 4px rgba(0, 119, 204, 0.1);
      display: inline-block;
      border: 2px solid gold;
      padding: 2px 6px;
      border-radius: 4px;
    }

    .draw-time-container {
      display: flex;
      gap: 15px;
      justify-content: center;
      padding: 10px;
      flex-wrap: wrap;
      margin-top: 5%;
    }

    .draw-box {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #f1faee;
      font-size: 16px;
      font-weight: 600;
      background-color: rgb(0, 0, 0);
      padding: 10px 20px;
      border-radius: 50px;
      backdrop-filter: blur(5px);
      letter-spacing: 1px;
      text-align: center;
      min-width: 180px;
    }

    #drawTime,
    #remainingTime {
      color: #ffdd57;
      font-weight: bold;
      font-size: 18px;
    }

    /* .blinking-border {
      display: flex;
      position: relative;
      padding: 40px;
      background-color: #000000;
      border-radius: 50%;
      text-align: center;
      width: 30px;
      height: 30px;
      justify-content: center;
      align-items: center;
      margin-top: 5%;
    }

    .blinking-border::before {
      content: "";
      position: absolute;
      top: -10px;
      left: -10px;
      right: -10px;
      bottom: -10px;
      border: 10px dotted gold;
      border-radius: 50%;
      animation: blinkBorder 0.6s infinite;
    }

    @keyframes blinkBorder {

      0%,
      100% {
        border-color: gold;
      }

      50% {
        border-color: transparent;
      }
    } */

    .digit {
      font-size: 24px;
      font-weight: bold;
      color: white;
      z-index: 1;
    }

    .blinking-row {
      display: flex;
      gap: 35px;
      justify-content: center;
      align-items: center;
    }

    footer {
      margin-top: 50px;
      color: white;
    }

    .main-section {
      margin-top: 5%;
    }

    .main-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 10%;
      width: 90%;
      max-width: 800px;
      border-radius: 20px;
      color: white;
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(30px);
      -webkit-backdrop-filter: blur(30px);
      box-shadow: 0 0 40px rgba(255, 215, 0, 0.3);
      margin-top: 30%;
    }

    .main-container::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: url('assets/home-page.gif');
      background-size: cover;
      background-position: center;
      filter: blur(5px);
      transform: scale(1.1);
      z-index: 0;
    }

    .main-container>* {
      position: relative;
      z-index: 1;
    }

    .game-type {
      font-size: 40px;
      color: white;
      font-weight: bold;
      text-shadow: 0 0 8px currentColor;
      animation: glow 1.5s ease-in-out infinite;
    }

    .game-type-cont {
      margin: 10px;
    }

    button {
      padding: 0.6rem 1.4rem;
      font-size: 1rem;
      font-weight: 600;
      font-family: 'Outfit', sans-serif;
      background: linear-gradient(135deg, #4facfe, #00f2fe);
      color: #fff;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      margin-top: 1rem;
      box-shadow: 0 6px 16px rgba(0, 200, 255, 0.15);
      transition: all 0.3s ease;
    }

    button:hover {
      background: linear-gradient(135deg, #38f9d7, #43e97b);
      color: #003f5c;
      transform: scale(1.05);
    }

    @media (max-width: 764px) {}

    @media (max-width: 480px) {

      button {
        margin-top: -20px;
      }

      .game-type {
        font-size: 30px !important;
      }

      .game-type-cont {
        margin: 10%;
      }

      .main-section {
        margin-top: -10%;
      }

      .main-container {
        text-align: center;
        align-items: center;
        justify-content: center;
        padding: 10%;
        border-radius: 5%;
        width: 85%;
        margin-left: 30px;
        margin-top: 5%;
      }

      .roller-container {
        gap: 5px !important;
      }
    }

    .digit-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
    }



    @media (min-width: 481px) and (max-width: 1024px) {
      /* tablet styles */
    }

    @media (min-width: 1025px) {
      .main-section {
        margin-top: -10%;
      }
    }

    .blinking-row {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 30px;
      margin-top: 15px;
    }

    .digit-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    .led-label {
      font-size: 24px;
      font-weight: 900;
      font-family: 'Outfit', sans-serif;
      text-shadow: 0 0 8px currentColor;
      animation: glow 1.5s ease-in-out infinite;
    }

    .led-label.a {
      color: gold;
    }

    .led-label.b {
      color: orange;
    }

    .led-label.c {
      color: #00ccff;
    }

    @keyframes glow {

      0%,
      100% {
        text-shadow:
          0 0 5px currentColor,
          0 0 10px currentColor,
          0 0 20px currentColor;
      }

      50% {
        text-shadow:
          0 0 3px currentColor,
          0 0 6px currentColor;
      }
    }

    .blinking-border {
      display: flex;
      position: relative;
      padding: 40px;
      background-color: black;
      border-radius: 50%;
      text-align: center;
      width: 30px;
      height: 30px;
      justify-content: center;
      align-items: center;
    }

    .blinking-border::before {
      content: "";
      position: absolute;
      top: -10px;
      left: -10px;
      right: -10px;
      bottom: -10px;
      border: 10px dotted gold;
      border-radius: 50%;
      animation: blinkBorder 0.6s infinite;
    }

    @keyframes blinkBorder {

      0%,
      100% {
        border-color: gold;
      }

      50% {
        border-color: transparent;
      }
    }

    .digit {
      font-size: 24px;
      font-weight: bold;
      color: white;
      z-index: 1;
    }

    .roller-container {
      display: flex;
      gap: 20px;
    }

    .digit-box {
      background: #111;
      border: 5px solid gold;
      border-radius: 15px;
      width: 100px;
      height: 130px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 5rem;
      color: gold;
      box-shadow: 0 0 30px gold;
    }

    /* .led-border {
            border: 10px dotted gold;
            border-radius: 15px;
        } */

    .led-border {
      display: flex;
      position: relative;
      background-color: #000000;
      border-radius: 15px;
      text-align: center;
      justify-content: center;
      align-items: center;
      margin: 10px;
    }

    .led-border::before {
      content: "";
      position: absolute;
      top: -10px;
      left: -10px;
      right: -10px;
      bottom: -10px;
      border: 10px dotted gold;
      border-radius: 15px;
      animation: blinkBorder 0.6s infinite;
    }

    @keyframes blinkBorder {

      0%,
      100% {
        border-color: gold;
      }

      50% {
        border-color: transparent;
      }
    }
  </style>
</head>

<body>
  <header class="slide-down">
    <nav class="fade-in">
      <a href="index.html">Home</a>
      <a href="today-result.html">Today Result</a>
      <a href="previous-result.html">Previous Result</a>
      <a href="result-file-download.html">Result File Download</a>
    </nav>
  </header>
  <section class="main-section fade-in">
    <div id="capture-area" class="main-container">
      <div id="screenshot-area" class="download-icon">
        <div>
          <h1>BIG BOSS</h1>
        </div>
        <div class="draw-time-container">
          <div class="draw-box">Draw Time: <span id="drawTime">--:--</span></div>
          <div class="draw-box no-screenshot">Remaining: <span id="remainingTime">--</span></div>
        </div>
        <!-- <div class="blinking-row">
          <div class="digit-container">
            <img height="50px" src="assets/A.png" alt="">
            <div class="blinking-border">
              <div id="digit1" class="digit">–</div>
            </div>
          </div>
          <div class="digit-container">
            <img height="50px" src="assets/B.png" alt="">
            <div class="blinking-border">
              <div id="digit2" class="digit">–</div>
            </div>
          </div>
          <div class="digit-container">
            <img height="50px" src="assets/C.png" alt="">
            <div class="blinking-border">
              <div id="digit3" class="digit">–</div>
            </div>
          </div>
        </div> -->

        <div class="roller-container">
          <div class="digit-container">
            <img height="50px" src="assets/A.png" alt="">
            <div class="led-border">
              <div class="digit-box" id="digit1">0</div>
            </div>
          </div>
          <div class="digit-container">
            <img height="50px" src="assets/B.png" alt="">
            <div class="led-border">
              <div class="digit-box" id="digit2">0</div>
            </div>
          </div>
          <div class="digit-container">
            <img height="50px" src="assets/C.png" alt="">
            <div class="led-border">
              <div class="digit-box" id="digit3">0</div>
            </div>
          </div>
        </div>

        <p id="result-status" class="no-screenshot"
          style="margin-top: 5%; color: white; font-weight: bold;font-size: 20px;"></p>
        <div class="game-type-cont">
          <h2 class="game-type" style="color: white;font-size: 40px;">3 Digit Game</h2>
        </div>
      </div>
      <button class="download-btn" id="download-btn">Download</button>


    </div>
  </section>

  <footer class="fade-in">
    <p>© 2025 Big Boss | All Rights Reserved</p>
  </footer>

  <!-- <script>
    document.getElementById("download-btn").addEventListener("click", function () {
      const original = document.getElementById("capture-area");
  
      // Clone the area
      const clone = original.cloneNode(true);
      const wrapper = document.createElement("div");
      wrapper.style.width = "720px";
      wrapper.style.height = "727px";
      wrapper.style.position = "fixed";
      wrapper.style.left = "-9999px";
      wrapper.style.top = "0";
      wrapper.style.overflow = "hidden";
      wrapper.style.backgroundColor = "#f9f9f9"; // Optional: background fix
      document.body.appendChild(wrapper);
  
      // Remove unwanted elements from clone only
      clone.querySelectorAll(".no-screenshot, #download-btn").forEach(el => el.remove());
  
      clone.style.width = "720px";
      clone.style.height = "727px";
      wrapper.appendChild(clone);
  
      html2canvas(clone, {
        width: 720,
        height: 727,
        scale: 1
      }).then(canvas => {
        const link = document.createElement("a");
        link.download = "screenshot.png";
        link.href = canvas.toDataURL("image/png");
        link.click();
        document.body.removeChild(wrapper); // Cleanup
      });
    });
  </script> -->


  <script>
    document.getElementById("download-btn").addEventListener("click", function () {
      const original = document.getElementById("screenshot-area");

      // Clone the capture area only
      const clone = original.cloneNode(true);
      const wrapper = document.createElement("div");

      // Set wrapper (which becomes the 720x720 canvas background)
      wrapper.style.width = "720px";
      wrapper.style.height = "720px";
      wrapper.style.display = "flex";
      wrapper.style.alignItems = "center";
      wrapper.style.justifyContent = "center";
      wrapper.style.position = "fixed";
      wrapper.style.left = "-9999px";
      wrapper.style.top = "0";
      wrapper.style.overflow = "hidden";
      wrapper.style.backgroundImage = "url('assets/home-page.gif')";
      wrapper.style.backgroundSize = "cover";
      wrapper.style.backgroundPosition = "center";

      // Cleanup unwanted elements
      clone.querySelectorAll(".no-screenshot, #download-btn").forEach(el => el.remove());

      // Style clone to fill the wrapper cleanly
      clone.style.display = "flex";
      clone.style.flexDirection = "column";
      clone.style.alignItems = "center";
      clone.style.justifyContent = "center";
      clone.style.width = "100%";
      clone.style.height = "100%";
      clone.style.padding = "0";
      clone.style.margin = "0";
      clone.style.boxSizing = "border-box";

      wrapper.appendChild(clone);
      document.body.appendChild(wrapper);

      html2canvas(wrapper, {
        width: 720,
        height: 720,
        backgroundColor: null,
        scale: 1,
        useCORS: true
      }).then(canvas => {
        const link = document.createElement("a");
        link.download = "big-boss.png";
        link.href = canvas.toDataURL("image/png");
        link.click();
        document.body.removeChild(wrapper);
      });
    });

  </script>


  <audio id="bg-music" autoplay loop>
    <source src="assets/music-for-page.mp3" type="audio/mpeg">
  </audio>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const audio = document.getElementById("bg-music");
      audio.volume = 0.2;

      const tryPlay = () => {
        audio.play().catch(() => {
          document.body.addEventListener("click", () => {
            audio.play();
          }, { once: true });
        });
      };
      tryPlay();
    });
  </script>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <!-- <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDcmamLjhZh8x6wRAiDeEtuB_Mky2tCOkI",
      authDomain: "lottery-e05d5.firebaseapp.com",
      databaseURL: "https://lottery-e05d5-default-rtdb.firebaseio.com",
      projectId: "lottery-e05d5",
      storageBucket: "lottery-e05d5.appspot.com",
      messagingSenderId: "357588305425",
      appId: "1:357588305425:web:d1608265a0743fdda693b0",
      measurementId: "G-GE938RN0DB"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function formatTime12hr(timeStr) {
      const [hour, minute] = timeStr.split(':');
      const h = parseInt(hour);
      const ampm = h >= 12 ? 'PM' : 'AM';
      const hr12 = h % 12 || 12;
      return `${hr12}:${minute} ${ampm}`;
    }

    function formatCountdown(ms) {
      if (ms < 0) return "Result time passed";
      const totalSecs = Math.floor(ms / 1000);
      const hrs = Math.floor(totalSecs / 3600);
      const mins = Math.floor((totalSecs % 3600) / 60);
      const secs = totalSecs % 60;
      return `${hrs > 0 ? hrs + 'h ' : ''}${mins}m ${secs}s`;
    }

    function updateCard(number) {
      document.getElementById('digit1').innerText = number[0];
      document.getElementById('digit2').innerText = number[1];
      document.getElementById('digit3').innerText = number[2];
    }

    function fetchLatestDraw() {
      const today = new Date().toISOString().split('T')[0];
      const now = new Date();
      const currentTime = now.toTimeString().slice(0, 5); // HH:MM

      db.ref('results/' + today).once('value').then(snapshot => {
        const results = snapshot.val();
        const status = document.getElementById('result-status');
        const drawTimeEl = document.getElementById('drawTime');
        const remainingEl = document.getElementById('remainingTime');

        if (!results) {
          drawTimeEl.innerText = '--:--';
          remainingEl.innerText = '--';
          status.innerText = "⏳ No draws available yet.";
          updateCard('–––');
          return;
        }

        const entries = Object.values(results).sort((a, b) => a.time.localeCompare(b.time));
        let currentDraw = null;
        let nextDraw = null;

        for (const entry of entries) {
          if (entry.time <= currentTime) {
            currentDraw = entry;
          } else if (!nextDraw) {
            nextDraw = entry;
          }
        }

        if (currentDraw) {
          updateCard(currentDraw.number);
          drawTimeEl.innerText = formatTime12hr(currentDraw.time);
          status.innerText = `✅ Result for ${formatTime12hr(currentDraw.time)} announced`;
        } else {
          updateCard('–––');
          status.innerText = "⏳ Waiting for first result...";
        }

        if (nextDraw) {
          const nextTime = new Date(today + 'T' + nextDraw.time + ':00');
          const timeDiff = nextTime - now;
          drawTimeEl.innerText = formatTime12hr(nextDraw.time);
          remainingEl.innerText = formatCountdown(timeDiff);
        } else if (!currentDraw) {
          drawTimeEl.innerText = '--:--';
          remainingEl.innerText = '--';
        }
      }).catch(err => {
        console.error(err);
        document.getElementById('result-status').innerText = '❌ Error fetching result.';
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      fetchLatestDraw();
      setInterval(fetchLatestDraw, 1000);
    });
  </script> -->

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDcmamLjhZh8x6wRAiDeEtuB_Mky2tCOkI",
      authDomain: "lottery-e05d5.firebaseapp.com",
      databaseURL: "https://lottery-e05d5-default-rtdb.firebaseio.com",
      projectId: "lottery-e05d5",
      storageBucket: "lottery-e05d5.appspot.com",
      messagingSenderId: "357588305425",
      appId: "1:357588305425:web:d1608265a0743fdda693b0",
      measurementId: "G-GE938RN0DB"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let randomInterval1, randomInterval2, randomInterval3;
    let isRunning = false;

    const digit = document.getElementById('digit1');
    const digit1 = document.getElementById('digit2');
    const digit2 = document.getElementById('digit3');

    function startRandomRun() {
      if (isRunning) return;
      isRunning = true;
      randomInterval1 = setInterval(() => {
        digit.textContent = Math.floor(Math.random() * 10);
      }, 100);
      randomInterval2 = setInterval(() => {
        digit1.textContent = Math.floor(Math.random() * 10);
      }, 102);
      randomInterval3 = setInterval(() => {
        digit2.textContent = Math.floor(Math.random() * 10);
      }, 105);
    }

    function stopRandomRun(number) {
      clearInterval(randomInterval1);
      clearInterval(randomInterval2);
      clearInterval(randomInterval3);
      isRunning = false;
      digit.textContent = number[0];
      digit1.textContent = number[1];
      digit2.textContent = number[2];
    }

    function formatTime12hr(timeStr) {
      const [hour, minute] = timeStr.split(':');
      const h = parseInt(hour);
      const ampm = h >= 12 ? 'PM' : 'AM';
      const hr12 = h % 12 || 12;
      return `${hr12}:${minute} ${ampm}`;
    }

    function formatCountdown(ms) {
      if (ms < 0) return "Result time passed";
      const totalSecs = Math.floor(ms / 1000);
      const hrs = Math.floor(totalSecs / 3600);
      const mins = Math.floor((totalSecs % 3600) / 60);
      const secs = totalSecs % 60;
      return `${hrs > 0 ? hrs + 'h ' : ''}${mins}m ${secs}s`;
    }

    function fetchLatestDraw() {
      const today = new Date().toISOString().split('T')[0];
      const now = new Date();
      const currentTime = now.toTimeString().slice(0, 5);

      db.ref('results/' + today).once('value').then(snapshot => {
        const results = snapshot.val();
        const status = document.getElementById('result-status');
        const drawTimeEl = document.getElementById('drawTime');
        const remainingEl = document.getElementById('remainingTime');

        if (!results) {
          drawTimeEl.innerText = '--:--';
          remainingEl.innerText = '--';
          status.innerText = "⏳ No draws available yet.";
          startRandomRun();
          return;
        }

        const entries = Object.values(results).sort((a, b) => a.time.localeCompare(b.time));
        let currentDraw = null;
        let nextDraw = null;

        for (const entry of entries) {
          if (entry.time <= currentTime) {
            currentDraw = entry;
          } else if (!nextDraw) {
            nextDraw = entry;
          }
        }

        const nowTime = now.getTime();
        const nextDrawTime = nextDraw
          ? new Date(`${today}T${nextDraw.time}:00`)
          : null;

        const fiveMinBeforeNext = nextDrawTime
          ? new Date(nextDrawTime.getTime() - 5 * 60 * 1000)
          : null;

        if (nextDraw) {
          // ✅ Always show upcoming draw time
          drawTimeEl.innerText = formatTime12hr(nextDraw.time);
          const diff = nextDrawTime - now;
          remainingEl.innerText = formatCountdown(diff);
        } else if (currentDraw) {
          drawTimeEl.innerText = formatTime12hr(currentDraw.time);
          remainingEl.innerText = "No more draws today";
        } else {
          drawTimeEl.innerText = '--:--';
          remainingEl.innerText = '--';
        }

        // 🎯 Logic for showing actual result or random digits
        if (currentDraw && (!nextDrawTime || now < fiveMinBeforeNext)) {
          stopRandomRun(currentDraw.number);
          status.innerText = `✅ Result for ${formatTime12hr(currentDraw.time)} announced`;
        } else {
          startRandomRun();
          status.innerText = nextDraw
            ? `🔁 Randomizing before ${formatTime12hr(nextDraw.time)} draw`
            : "🔁 Waiting for next result...";
        }
      }).catch(err => {
        console.error(err);
        document.getElementById('result-status').innerText = '❌ Error fetching result.';
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      fetchLatestDraw();
      setInterval(fetchLatestDraw, 1000);
    });
  </script>


</body>

</html>